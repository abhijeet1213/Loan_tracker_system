<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="cms">
  <meta name="author" content="AKservices">
  {% load static %}
  <title>AKservises</title>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
</head>
<style>
    .swal-button{
    width: 200px !important;
    }
    html,body { height: 100%; }

body{
	display: -ms-flexbox;
	display: -webkit-box;
	display: flex;
	-ms-flex-align: center;
	-ms-flex-pack: center;
	-webkit-box-align: center;
	align-items: center;
	-webkit-box-pack: center;
	justify-content: center;
	background-color: #f5f5f5;
}

form{
	padding-top: 10px;
	font-size: 13px;
	margin-top: 30px;
}

.card-title{ font-weight:300; }

.btn{
	font-size: 13px;
}

.login-form{ 
	width:320px;
	margin:20px;
}

.sign-up{
	text-align:center;
	padding:20px 0 0;
}

span{
	font-size:14px;
}

.submit-btn{
	margin-top:20px;
}
</style>
<body>

    <div class="card login-form">
        <div class="card-body">
            <h3 class="card-title text-center">Change your password</h3>
            
            <!--Password must contain one lowercase letter, one number, and be at least 7 characters long.-->
            
            <div class="card-text">
                <form>
                   
        
        </div>
       
                        <div class="form-group">
                        <label for="exampleInputEmail1">Your new password</label>
                        <input type="password" id="p1" class="form-control form-control-sm">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail1">Repeat password</label>
                        <input type="password" id="p2" class="form-control form-control-sm">
                    </div>
                    <div align="right" class="col-sm">
                        <a  onclick="password_change()" id="save_button" type="Submit"
                        class="btn btn-primary  btn-block" style="background-color:#f8fcff; width:100%"><b>Confirm</b></a>


            </div>
                </form>
            </div>
        </div>
    </div>

</body>
<script>
    function password_change()
    {
        var p0=$("#p0").val();
        var p1=$("#p1").val();
        var p2=$("#p2").val();
        
        if (!p1)
        
           
            Swal.fire({
                width:'400px',
                icon: 'error',
                title: 'Oops...',
                text: 'Please enter the new password',
                
                })
            

        else if (!p2)
        
          
            Swal.fire({
                width:'400px',
                icon: 'error',
                title: 'Oops...',
                text: 'Please enter the repeat password!',
                
                })
            

        else if (p1.length < 7)
        
           
            Swal.fire({
                
                icon: 'error',
                title: 'Oops...',
                text: 'Minimum password length should seven character!',
                
                })
        

        else if (p1 != p2)
    
           
            Swal.fire({
                width:'400px',
                icon: 'error',
                title: 'Oops...',
                text: 'Password does not match!',
                
                })
            
    else
        Swal.fire({
                title: 'Do you want to save the changes?',
                icon: "warning",
              
                
                showDenyButton: true,
                showCancelButton: false,
                confirmButtonText: 'Yes',
                denyButtonText: `No `,
        }).then((result) => {
            /* Read more about isConfirmed, isDenied below */
            if (result.isConfirmed) {
                
                $.ajax
                    (
                        {                       // initialize an AJAX request
                            method: "POST",
                            url: "/password_reset",
                            contentType:"application/json",
                            dataType:'text',
                            data: JSON.stringify({
                                'p1':p1,
                                'p0':p0
                               
                                  }),

                            success: function (response) {
                               
                                
                                    
                                    Swal.fire('Saved!', response, 'success')    
                                    Swal.fire({
                                        
                                        icon: 'success',
                                        title: "Password has been changed successfully",
                                        
                                        showConfirmButton: true,
                                       
                                    }).then(function () {
                                        location.href = "/";
                                    });
                                
                            }


                        }
                    );

            } else if (result.isDenied) {
                Swal.fire('Changes are not saved', '', 'info')
            }
        })

    }
        

    

</script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</html>